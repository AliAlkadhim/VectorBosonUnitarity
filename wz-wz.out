FORM 4.1 (Oct 25 2013) 64-bits                   Run: Sat Oct 23 16:22:38 2021
    nwrite statistics;
    
    V p1,p2,p3,p4,ks,ku,p,k;
    I mu1,mu2,mu3,mu4,nu1,nu2,nu3,nu4,mu,nu,la,al,be;
    S gwwz,gwwzz,s,t,u,mw,mz,[s-mw^2],[u-mw^2],[t-2*mw^2],[t-2*mz^2],[s+u],E,[t],[s]
    ,[u],n;
    V eps1,eps2,eps3,eps4;
    CF Vwwz,Vwwzz,propw,As,Au,A4,A4test,g;
    
    ** Define amplitude structure:
    ** [overall factor from couplings]*[polarization vectors]*[all the rest]
    
    L Ms = -gwwz^2*eps1(mu1)*eps2(mu2)*eps3(mu3)*eps4(mu4)*As(p1,p2,p3,p4,mu1,mu2,mu
    3,mu4);
    L Mu = gwwz^2*eps1(mu1)*eps2(mu2)*eps3(mu3)*eps4(mu4)*Au(p1,p2,p3,p4,mu1,mu2,mu3
    ,mu4);
    L M4 = gwwzz*eps1(mu1)*eps2(mu2)*eps3(mu3)*eps4(mu4)*A4(mu1,mu2,mu3,mu4);
    
    ** Express [all the rest] in terms of vertices and propagators:
    ** Vwwz: WWZ vertex
    ** Vwwzz: WWZZ vertex
    ** propw: W propagator
    
    id As(p1?,p2?,p3?,p4?,mu1?,mu2?,mu3?,mu4?)=Vwwz(-ks,p1,p2,nu,mu1,mu2)*Vwwz(-p3,k
    s,-p4,mu3,la,mu4)*propw(s,ks,nu,la);
    id Au(p1?,p2?,p3?,p4?,mu1?,mu2?,mu3?,mu4?)=Vwwz(p1,-ku,-p4,mu1,nu,mu4)*Vwwz(-p3,
    ku,p2,mu3,la,mu2)*propw(u,ku,nu,la);
    id A4(mu1?,mu2?,mu3?,mu4?)=Vwwzz(mu1,mu3,mu2,mu4);
    
    
    ** Feynman rules For vertices and propagators
    
    id Vwwz(p1?,p2?,p3?,mu1?,mu2?,mu3?)=d_(mu1,mu2)*(p1(mu3)-p2(mu3))+d_(mu2,mu3)*(p
    2(mu1)-p3(mu1))+d_(mu3,mu1)*(p3(mu2)-p1(mu2));
    id Vwwzz(mu?,nu?,al?,be?)=d_(al,mu)*d_(be,nu)+d_(al,nu)*d_(be,mu)-2*d_(al,be)*d_
    (mu,nu);
    
    id propw(s,k?,nu?,la?)=1/[s-mw^2]*(-d_(nu,la)+k(nu)*k(la)/mw^2);
    id propw(u,k?,nu?,la?)=1/[u-mw^2]*(-d_(nu,la)+k(nu)*k(la)/mw^2);
    
    
    ** Use that p*eps(p)=0, and substitute expression for polarization vectors
    
    id p1.eps1=0;
    id p2.eps2=0;
    id p3.eps3=0;
    id p4.eps4=0;
    
    id eps1.p?=p1.p/mw+2*mw/[t-2*mw^2]*p3.p;
    id eps2.p?=p2.p/mz+2*mz/[t-2*mz^2]*p4.p;
    id eps3.p?=p3.p/mw+2*mw/[t-2*mw^2]*p1.p;
    id eps4.p?=p4.p/mz+2*mz/[t-2*mz^2]*p2.p;
    
    
    ** Simplify result using simple kinematic relations and express it in terms of {
    s,t,u}
    
    repeat;
    id p?.ks=p.p1+p.p2;
    id p?.ku=p.p3-p.p2;
    id p4.k?=-p3.k+p1.k+p2.k;
    
    id p1.p1=mw^2;
    id p2.p2=mz^2;
    id p3.p3=mw^2;
    
    id p1.p2=1/2*(s-mw^2-mz^2);
    id p1.p3=-1/2*(t-2*mw^2);
    id p2.p3=-1/2*(u-mw^2-mz^2);
    
    id u=-s-t+2*mw^2+2*mz^2;
    
    endrepeat;
    
    bracket gwwz,gwwzz,[s-mw^2],[u-mw^2],[t-2*mw^2],[t-2*mz^2],mw,mz;
    print;
    .sort

   Ms =
       + gwwz^2*mw^-4*mz^2*[s-mw^2]^-1*[t-2*mz^2]^-2 * (  - 1/4*s^2*t^2 )

       + gwwz^2*mw^-4*mz^4*[s-mw^2]^-1*[t-2*mz^2]^-2 * (  - 1/2*s*t^2 )

       + gwwz^2*mw^-4*mz^6*[s-mw^2]^-1*[t-2*mz^2]^-2 * (  - 1/4*t^2 )

       + gwwz^2*mw^-2*mz^-2*[s-mw^2]^-1 * (  - 1/2*s^2*t - 1/4*s^3 )

       + gwwz^2*mw^-2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 1/2*s^2*t^2
          )

       + gwwz^2*mw^-2*[s-mw^2]^-1*[t-2*mz^2]^-1 * ( s*t^2 + 1/2*s^2*t - s^3 )

       + gwwz^2*mw^-2*[s-mw^2]^-1 * ( 1/2*s^2 )

       + gwwz^2*mw^-2*mz^2*[s-mw^2]^-1*[t-2*mz^2]^-2 * (  - 1/2*t^3 + 1/2*s*
         t^2 - s^2*t - s^3 )

       + gwwz^2*mw^-2*mz^2*[s-mw^2]^-1*[t-2*mz^2]^-1 * (  - 3*s*t + 2*s^2 )

       + gwwz^2*mw^-2*mz^2*[s-mw^2]^-1 * (  - 1/4*s )

       + gwwz^2*mw^-2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 2*s*t^2
          )

       + gwwz^2*mw^-2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 1/2*
         t^2 )

       + gwwz^2*mw^-2*mz^4*[s-mw^2]^-1*[t-2*mz^2]^-2 * ( 7/2*t^2 + 2*s*t + 2*
         s^2 )

       + gwwz^2*mw^-2*mz^4*[s-mw^2]^-1*[t-2*mz^2]^-1 * ( 1/2*t - s )

       + gwwz^2*mw^-2*mz^6*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 2*t^2 )

       + gwwz^2*mw^-2*mz^6*[s-mw^2]^-1*[t-2*mz^2]^-2 * (  - 3*t - s )

       + gwwz^2*mz^-2*[s-mw^2]^-1*[t-2*mw^2]^-2 * (  - 1/4*s^2*t^2 )

       + gwwz^2*mz^-2*[s-mw^2]^-1*[t-2*mw^2]^-1 * ( s*t^2 + 1/2*s^2*t - s^3 )

       + gwwz^2*mz^-2*[s-mw^2]^-1 * ( 1/2*s^2 )

       + gwwz^2*[s-mw^2]^-1*[t-2*mw^2]^-2 * ( 1/2*s*t^2 )

       + gwwz^2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - t^3 - s*t^2 - 4
         *s^3 )

       + gwwz^2*[s-mw^2]^-1*[t-2*mw^2]^-1 * (  - s*t + 2*s^2 )

       + gwwz^2*[s-mw^2]^-1*[t-2*mz^2]^-1 * (  - s*t + 2*s^2 )

       + gwwz^2*[s-mw^2]^-1 * ( 1/2*s )

       + gwwz^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 2*s*t^2 )

       + gwwz^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2 * (  - 1/4*t^2 )

       + gwwz^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 12*s*t^2
          - 18*s^2*t - 4*s^3 )

       + gwwz^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 4*t^2 + 8*s^2
          )

       + gwwz^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-1 * ( 1/2*t - s )

       + gwwz^2*mz^2*[s-mw^2]^-1*[t-2*mz^2]^-2 * (  - 1/4*t^2 - 2*s*t + 2*s^2
          )

       + gwwz^2*mz^2*[s-mw^2]^-1*[t-2*mz^2]^-1 * (  - t + 2*s )

       + gwwz^2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 2*t^2 )

       + gwwz^2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 2*t^2 + 36*s*
         t + 8*s^2 )

       + gwwz^2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 4*s )

       + gwwz^2*mz^4*[s-mw^2]^-1*[t-2*mz^2]^-2 * (  - 2*t + 2*s )

       + gwwz^2*mz^6*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 4*t^2 )

       + gwwz^2*mz^6*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 18*t - 4*s
          )

       + gwwz^2*mw^2*mz^-2*[s-mw^2]^-1*[t-2*mw^2]^-2 * (  - 1/2*t^3 - 1/2*s*
         t^2 - s^2*t - s^3 )

       + gwwz^2*mw^2*mz^-2*[s-mw^2]^-1*[t-2*mw^2]^-1 * (  - 3*s*t + 2*s^2 )

       + gwwz^2*mw^2*mz^-2*[s-mw^2]^-1 * (  - 1/4*s )

       + gwwz^2*mw^2*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 8*s*t^2 - 
         18*s^2*t - 4*s^3 )

       + gwwz^2*mw^2*[s-mw^2]^-1*[t-2*mw^2]^-2 * ( 1/2*t^2 - 2*s*t + 2*s^2 )

       + gwwz^2*mw^2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 5/2*t^2 + 8*
         s^2 )

       + gwwz^2*mw^2*[s-mw^2]^-1*[t-2*mw^2]^-1 * (  - t + 2*s )

       + gwwz^2*mw^2*[s-mw^2]^-1*[t-2*mz^2]^-1 * ( 1/2*t - s )

       + gwwz^2*mw^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 8*t^3
          - 36*s*t^2 - 48*s^2*t - 4*s^3 )

       + gwwz^2*mw^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 2*t^2
          + 12*s*t + 8*s^2 )

       + gwwz^2*mw^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2 * ( t - s )

       + gwwz^2*mw^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 4*t^2 + 
         12*s*t + 8*s^2 )

       + gwwz^2*mw^2*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 8*t
          + 8*s )

       + gwwz^2*mw^2*mz^2*[s-mw^2]^-1*[t-2*mz^2]^-2 * ( t - s )

       + gwwz^2*mw^2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 32*t^2
          + 64*s*t + 8*s^2 )

       + gwwz^2*mw^2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 2*t
          - 4*s )

       + gwwz^2*mw^2*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 12*t
          + 8*s )

       + gwwz^2*mw^2*mz^6*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 24*t
          - 4*s )

       + gwwz^2*mw^4*mz^-2*[s-mw^2]^-1*[t-2*mw^2]^-2 * ( 11/4*t^2 + 2*s*t + 2*
         s^2 )

       + gwwz^2*mw^4*mz^-2*[s-mw^2]^-1*[t-2*mw^2]^-1 * ( 1/2*t - s )

       + gwwz^2*mw^4*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 8*t^2 + 36*s*
         t + 8*s^2 )

       + gwwz^2*mw^4*[s-mw^2]^-1*[t-2*mw^2]^-2 * (  - 2*t + 2*s )

       + gwwz^2*mw^4*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 4*s )

       + gwwz^2*mw^4*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 20*t^2
          + 64*s*t + 8*s^2 )

       + gwwz^2*mw^4*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 12*t
          + 8*s )

       + gwwz^2*mw^4*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 2*t
          - 4*s )

       + gwwz^2*mw^4*mz^4*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 16*t
          + 8*s )

       + gwwz^2*mw^6*mz^-2*[s-mw^2]^-1*[t-2*mw^2]^-2 * (  - 3*t - s )

       + gwwz^2*mw^6*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 18*t - 4*s
          )

       + gwwz^2*mw^6*mz^2*[s-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 24*t
          - 4*s );

   Mu =
       + gwwz^2*mw^-4*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-2 * (  - 1/4*t^4 - 1/2*s*
         t^3 - 1/4*s^2*t^2 )

       + gwwz^2*mw^-4*mz^4*[u-mw^2]^-1*[t-2*mz^2]^-2 * ( 3/2*t^3 + 3/2*s*t^2 )

       + gwwz^2*mw^-4*mz^6*[u-mw^2]^-1*[t-2*mz^2]^-2 * (  - 9/4*t^2 )

       + gwwz^2*mw^-2*mz^-2*[u-mw^2]^-1 * (  - 1/4*t^3 - 1/4*s*t^2 + 1/4*s^2*t
          + 1/4*s^3 )

       + gwwz^2*mw^-2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 1/2*t^4 + s*
         t^3 + 1/2*s^2*t^2 )

       + gwwz^2*mw^-2*[u-mw^2]^-1*[t-2*mz^2]^-1 * ( 1/2*t^3 + 3*s*t^2 + 7/2*
         s^2*t + s^3 )

       + gwwz^2*mw^-2*[u-mw^2]^-1 * ( t^2 - s^2 )

       + gwwz^2*mw^-2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 2*
         t^3 - 2*s*t^2 )

       + gwwz^2*mw^-2*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-2 * ( 3/2*s*t^2 + 2*s^2*t
          + s^3 )

       + gwwz^2*mw^-2*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-1 * (  - t^2 - 7*s*t - 4*
         s^2 )

       + gwwz^2*mw^-2*mz^2*[u-mw^2]^-1 * (  - 3/4*t + 5/4*s )

       + gwwz^2*mw^-2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 2*
         t^3 - 2*s*t^2 )

       + gwwz^2*mw^-2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 3/2*t^2
          )

       + gwwz^2*mw^-2*mz^4*[u-mw^2]^-1*[t-2*mz^2]^-2 * (  - 1/2*t^2 - 6*s*t - 
         4*s^2 )

       + gwwz^2*mw^-2*mz^4*[u-mw^2]^-1*[t-2*mz^2]^-1 * ( 3/2*t + 5*s )

       + gwwz^2*mw^-2*mz^4*[u-mw^2]^-1 * (  - 1/2 )

       + gwwz^2*mw^-2*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 6*t^2 )

       + gwwz^2*mw^-2*mz^6*[u-mw^2]^-1*[t-2*mz^2]^-2 * ( 2*t + 5*s )

       + gwwz^2*mw^-2*mz^6*[u-mw^2]^-1*[t-2*mz^2]^-1 * (  - 2 )

       + gwwz^2*mw^-2*mz^8*[u-mw^2]^-1*[t-2*mz^2]^-2 * (  - 2 )

       + gwwz^2*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-2 * (  - 1/4*t^4 - 1/2*s*t^3 - 1/
         4*s^2*t^2 )

       + gwwz^2*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-1 * ( 1/2*t^3 + 3*s*t^2 + 7/2*
         s^2*t + s^3 )

       + gwwz^2*mz^-2*[u-mw^2]^-1 * ( t^2 - s^2 )

       + gwwz^2*[u-mw^2]^-1*[t-2*mw^2]^-2 * ( 1/2*t^3 + 1/2*s*t^2 )

       + gwwz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 2*t^3 + 11*s*t^2
          + 12*s^2*t + 4*s^3 )

       + gwwz^2*[u-mw^2]^-1*[t-2*mw^2]^-1 * (  - 3*t^2 - 9*s*t - 4*s^2 )

       + gwwz^2*[u-mw^2]^-1*[t-2*mz^2]^-1 * (  - 3*t^2 - 9*s*t - 4*s^2 )

       + gwwz^2*[u-mw^2]^-1 * (  - 5/2*t + 3/2*s )

       + gwwz^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 2*t^3 + 2*s*
         t^2 )

       + gwwz^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2 * (  - 1/4*t^2 )

       + gwwz^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 2*t^3 - 12
         *s*t^2 - 6*s^2*t + 4*s^3 )

       + gwwz^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 10*t^2 - 
         32*s*t - 16*s^2 )

       + gwwz^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1 * ( 11/2*t + 5*s )

       + gwwz^2*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-2 * ( 7/4*t^2 - 2*s*t - 4*s^2 )

       + gwwz^2*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-1 * ( t + 6*s )

       + gwwz^2*mz^2*[u-mw^2]^-1 * ( 1/2 )

       + gwwz^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 2*t^2 )

       + gwwz^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 2*t^2 + 4*s*t
          - 16*s^2 )

       + gwwz^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 20*t + 20*s )

       + gwwz^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1 * (  - 2 )

       + gwwz^2*mz^4*[u-mw^2]^-1*[t-2*mz^2]^-2 * (  - 4*t + 6*s )

       + gwwz^2*mz^4*[u-mw^2]^-1*[t-2*mz^2]^-1 * ( 2 )

       + gwwz^2*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 4*t^2 )

       + gwwz^2*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 2*t + 20*s )

       + gwwz^2*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 8 )

       + gwwz^2*mz^6*[u-mw^2]^-1*[t-2*mz^2]^-2 * ( 2 )

       + gwwz^2*mz^8*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 8 )

       + gwwz^2*mw^2*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-2 * ( t^3 + 5/2*s*t^2 + 2*
         s^2*t + s^3 )

       + gwwz^2*mw^2*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-1 * (  - t^2 - 7*s*t - 4*
         s^2 )

       + gwwz^2*mw^2*mz^-2*[u-mw^2]^-1 * (  - 3/4*t + 5/4*s )

       + gwwz^2*mw^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 6*t^3 - 16
         *s*t^2 - 6*s^2*t + 4*s^3 )

       + gwwz^2*mw^2*[u-mw^2]^-1*[t-2*mw^2]^-2 * ( 1/2*t^2 - 2*s*t - 4*s^2 )

       + gwwz^2*mw^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 27/2*t^2
          - 32*s*t - 16*s^2 )

       + gwwz^2*mw^2*[u-mw^2]^-1*[t-2*mw^2]^-1 * ( t + 6*s )

       + gwwz^2*mw^2*[u-mw^2]^-1*[t-2*mz^2]^-1 * ( 11/2*t + 5*s )

       + gwwz^2*mw^2*[u-mw^2]^-1 * ( 1/2 )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 16*
         t^3 - 48*s*t^2 - 36*s^2*t + 4*s^3 )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 22*t^2
          + 28*s*t - 16*s^2 )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2 * (  - 2*t + 5*s )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 24*t^2
          + 28*s*t - 16*s^2 )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 16*t + 
         24*s )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1 * ( 2 )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-2 * (  - 2*t + 5*s )

       + gwwz^2*mw^2*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-1 * ( 2 )

       + gwwz^2*mw^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 72*t^2
          + 96*s*t - 16*s^2 )

       + gwwz^2*mw^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 30*t
          + 20*s )

       + gwwz^2*mw^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-2 * (  - 2 )

       + gwwz^2*mw^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 36*t
          + 24*s )

       + gwwz^2*mw^2*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 8 )

       + gwwz^2*mw^2*mz^4*[u-mw^2]^-1*[t-2*mz^2]^-2 * ( 2 )

       + gwwz^2*mw^2*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 68*t
          + 20*s )

       + gwwz^2*mw^2*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 8 )

       + gwwz^2*mw^2*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 8 )

       + gwwz^2*mw^2*mz^8*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 8 )

       + gwwz^2*mw^4*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-2 * (  - 5/4*t^2 - 6*s*t - 
         4*s^2 )

       + gwwz^2*mw^4*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-1 * ( 3/2*t + 5*s )

       + gwwz^2*mw^4*mz^-2*[u-mw^2]^-1 * (  - 1/2 )

       + gwwz^2*mw^4*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 12*t^2 + 4*s*
         t - 16*s^2 )

       + gwwz^2*mw^4*[u-mw^2]^-1*[t-2*mw^2]^-2 * (  - 4*t + 6*s )

       + gwwz^2*mw^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 20*t + 20*s )

       + gwwz^2*mw^4*[u-mw^2]^-1*[t-2*mw^2]^-1 * ( 2 )

       + gwwz^2*mw^4*[u-mw^2]^-1*[t-2*mz^2]^-1 * (  - 2 )

       + gwwz^2*mw^4*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 60*t^2
          + 96*s*t - 16*s^2 )

       + gwwz^2*mw^4*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 36*t
          + 24*s )

       + gwwz^2*mw^4*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2 * ( 2 )

       + gwwz^2*mw^4*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 30*t
          + 20*s )

       + gwwz^2*mw^4*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 8 )

       + gwwz^2*mw^4*mz^2*[u-mw^2]^-1*[t-2*mz^2]^-2 * (  - 2 )

       + gwwz^2*mw^4*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 120*t
          + 24*s )

       + gwwz^2*mw^4*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 8 )

       + gwwz^2*mw^4*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 8 )

       + gwwz^2*mw^4*mz^6*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 8 )

       + gwwz^2*mw^6*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-2 * ( 2*t + 5*s )

       + gwwz^2*mw^6*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-1 * (  - 2 )

       + gwwz^2*mw^6*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 2*t + 20*s )

       + gwwz^2*mw^6*[u-mw^2]^-1*[t-2*mw^2]^-2 * ( 2 )

       + gwwz^2*mw^6*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 8 )

       + gwwz^2*mw^6*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 68*t
          + 20*s )

       + gwwz^2*mw^6*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 8 )

       + gwwz^2*mw^6*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 8 )

       + gwwz^2*mw^6*mz^4*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 8 )

       + gwwz^2*mw^8*mz^-2*[u-mw^2]^-1*[t-2*mw^2]^-2 * (  - 2 )

       + gwwz^2*mw^8*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 8 )

       + gwwz^2*mw^8*mz^2*[u-mw^2]^-1*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 8 );

   M4 =
       + gwwzz*mw^-2*mz^-2 * (  - 1/4*t^2 + 1/2*s*t + 1/2*s^2 )

       + gwwzz*mw^-2*[t-2*mz^2]^-1 * ( 2*s*t + 2*s^2 )

       + gwwzz*mw^-2 * ( 1/2*t - s )

       + gwwzz*mw^-2*mz^2*[t-2*mz^2]^-2 * (  - t^2 + 2*s*t + 2*s^2 )

       + gwwzz*mw^-2*mz^2*[t-2*mz^2]^-1 * ( 2*t - 4*s )

       + gwwzz*mw^-2*mz^2 * ( 1/2 )

       + gwwzz*mw^-2*mz^4*[t-2*mz^2]^-2 * ( 2*t - 4*s )

       + gwwzz*mw^-2*mz^4*[t-2*mz^2]^-1 * ( 2 )

       + gwwzz*mw^-2*mz^6*[t-2*mz^2]^-2 * ( 2 )

       + gwwzz*mz^-2*[t-2*mw^2]^-1 * ( 2*s*t + 2*s^2 )

       + gwwzz*mz^-2 * ( 1/2*t - s )

       + gwwzz*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 4*t^2 + 8*s*t + 8*s^2 )

       + gwwzz*[t-2*mw^2]^-1 * (  - 2*t - 4*s )

       + gwwzz*[t-2*mz^2]^-1 * (  - 2*t - 4*s )

       + gwwzz * (  - 1 )

       + gwwzz*mz^2*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 8*s*t + 8*s^2 )

       + gwwzz*mz^2*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 8*t - 16*s )

       + gwwzz*mz^2*[t-2*mw^2]^-1 * ( 2 )

       + gwwzz*mz^2*[t-2*mz^2]^-2 * ( 2*t - 4*s )

       + gwwzz*mz^2*[t-2*mz^2]^-1 * (  - 4 )

       + gwwzz*mz^4*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 8*t - 16*s )

       + gwwzz*mz^4*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 8 )

       + gwwzz*mz^4*[t-2*mz^2]^-2 * (  - 4 )

       + gwwzz*mz^6*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 8 )

       + gwwzz*mw^2*mz^-2*[t-2*mw^2]^-2 * (  - t^2 + 2*s*t + 2*s^2 )

       + gwwzz*mw^2*mz^-2*[t-2*mw^2]^-1 * ( 2*t - 4*s )

       + gwwzz*mw^2*mz^-2 * ( 1/2 )

       + gwwzz*mw^2*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 8*s*t + 8*s^2 )

       + gwwzz*mw^2*[t-2*mw^2]^-2 * ( 2*t - 4*s )

       + gwwzz*mw^2*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 8*t - 16*s )

       + gwwzz*mw^2*[t-2*mw^2]^-1 * (  - 4 )

       + gwwzz*mw^2*[t-2*mz^2]^-1 * ( 2 )

       + gwwzz*mw^2*mz^2*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 4*t^2 + 8*s*t + 8*
         s^2 )

       + gwwzz*mw^2*mz^2*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 8*t - 16*s )

       + gwwzz*mw^2*mz^2*[t-2*mw^2]^-2 * ( 2 )

       + gwwzz*mw^2*mz^2*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 8*t - 16*s )

       + gwwzz*mw^2*mz^2*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * (  - 16 )

       + gwwzz*mw^2*mz^2*[t-2*mz^2]^-2 * ( 2 )

       + gwwzz*mw^2*mz^4*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 8*t - 16*s )

       + gwwzz*mw^2*mz^4*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 8 )

       + gwwzz*mw^2*mz^4*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * (  - 16 )

       + gwwzz*mw^2*mz^6*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 8 )

       + gwwzz*mw^4*mz^-2*[t-2*mw^2]^-2 * ( 2*t - 4*s )

       + gwwzz*mw^4*mz^-2*[t-2*mw^2]^-1 * ( 2 )

       + gwwzz*mw^4*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 8*t - 16*s )

       + gwwzz*mw^4*[t-2*mw^2]^-2 * (  - 4 )

       + gwwzz*mw^4*[t-2*mw^2]^-1*[t-2*mz^2]^-1 * ( 8 )

       + gwwzz*mw^4*mz^2*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 8*t - 16*s )

       + gwwzz*mw^4*mz^2*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * (  - 16 )

       + gwwzz*mw^4*mz^2*[t-2*mw^2]^-1*[t-2*mz^2]^-2 * ( 8 )

       + gwwzz*mw^4*mz^4*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * (  - 16 )

       + gwwzz*mw^6*mz^-2*[t-2*mw^2]^-2 * ( 2 )

       + gwwzz*mw^6*[t-2*mw^2]^-2*[t-2*mz^2]^-1 * ( 8 )

       + gwwzz*mw^6*mz^2*[t-2*mw^2]^-2*[t-2*mz^2]^-2 * ( 8 );

    
    
    ** Try further simplifications and expand denominators in the large-energy limit
     {s,t,u}>>{MW,MZ}
    
    repeat;
    id s*[s-mw^2]^-1=1+mw^2*[s-mw^2]^-1;
    id u*[u-mw^2]^-1=1+mw^2*[u-mw^2]^-1;
    id t*[t-2*mw^2]^-1=1+2*mw^2*[t-2*mw^2]^-1;
    id t*[t-2*mz^2]^-1=1+2*mz^2*[t-2*mz^2]^-1;
    endrepeat;
    .sort
    
    repeat;
    id [s-mw^2]^-1=1/s*(1+mw^2/s+mw^4/s^2);
    id [u-mw^2]^-1=1/u*(1+mw^2/u+mw^4/u^2);
    id [t-2*mw^2]^-1=1/t*(1+2*mw^2/t+4*mw^4/t^2);
    id [t-2*mz^2]^-1=1/t*(1+2*mz^2/t+4*mz^4/t^2);
    
    
    ** Keep only leading terms in the large-energy limit. To achieve that, rescale a
    ll invariants by a suitable energy factor (E^n) and then drop all terms proporti
    onal to negative powers of E. This requires to introduce different symbols for t
    he rescaled invariants.
    
    id t=E^2*[t];
    id s=E^2*[s];
    id u=E^2*[u];
    id t^-1=E^-2*[t]^-1;
    id s^-1=E^-2*[s]^-1;
    id u^-1=E^-2*[u]^-1;
    endrepeat;
    
    id E^n?neg0_ = 0;
    
    bracket gwwz,gwwzz,[s-mw^2],[u-mw^2],[t-2*mw^2],[t-2*mz^2],mw,mz,E;
    print;
    .sort

   Ms =
       + gwwz^2*mw^-4*mz^2*E^2 * (  - 1/4*[s] )

       + gwwz^2*mw^-2*mz^-2*E^4 * (  - 1/4*[s]^2 - 1/2*[t]*[s] )

       + gwwz^2*mw^-2*E^2 * (  - [t]^-1*[s]^2 + 3/2*[s] + [t] )

       + gwwz^2*mz^-2*E^2 * (  - [t]^-1*[s]^2 + 1/2*[s] + 1/2*[t] );

   Mu =
       + gwwz^2*mw^-4*mz^2*E^2 * (  - 1/4*[s]^2*[u]^-1 - 1/2*[t]*[s]*[u]^-1 - 
         1/4*[t]^2*[u]^-1 )

       + gwwz^2*mw^-2*mz^-2*E^4 * ( 1/4*[s]^3*[u]^-1 + 1/4*[t]*[s]^2*[u]^-1 - 
         1/4*[t]^2*[s]*[u]^-1 - 1/4*[t]^3*[u]^-1 )

       + gwwz^2*mw^-2*E^2 * ( [t]^-1*[s]^3*[u]^-1 + 3*[s]^2*[u]^-1 + 4*[t]*[s]
         *[u]^-1 + 2*[t]^2*[u]^-1 )

       + gwwz^2*mz^-2*E^2 * ( [t]^-1*[s]^3*[u]^-1 + 9/4*[s]^2*[u]^-1 + 1/4*
         [s]^3*[u]^-2 + 5/2*[t]*[s]*[u]^-1 + 1/4*[t]*[s]^2*[u]^-2 + 5/4*[t]^2*
         [u]^-1 - 1/4*[t]^2*[s]*[u]^-2 - 1/4*[t]^3*[u]^-2 );

   M4 =
       + gwwzz*mw^-2*mz^-2*E^4 * ( 1/2*[s]^2 + 1/2*[t]*[s] - 1/4*[t]^2 )

       + gwwzz*mw^-2*E^2 * ( 2*[t]^-1*[s]^2 + [s] + 1/2*[t] )

       + gwwzz*mz^-2*E^2 * ( 2*[t]^-1*[s]^2 + [s] + 1/2*[t] );

    
    
    ** Revert back to {s,t,u}. To compare with Schwartz's results, eliminate t in fa
    vor of {s,u}.
    
    repeat;
    id [s]=s;
    id [s]^-1=s^-1;
    id [t]=-s-u+(2*mw^2+2*mz^2)/E^2;
    id [t]^-1=-[s+u]^-1*(1+2*(mw^2+mz^2)/E^2/[s+u]);
    id [u]=u;
    id [u]^-1=u^-1;
    endrepeat;
    
    id E^n?neg0_ = 0;
    
    ** Ms, Mu, And M4 in the final printout (see wz-wz.out) agree With Eq.(29.22), (
    29.23), And (29.24) of Schwratz's book (you just need to perform a little algebr
    a to assemble terms with the same prefactor).
    
    bracket gwwz,gwwzz,[s-mw^2],[u-mw^2],[t-2*mw^2],[t-2*mz^2],[s+u],mw,mz,E;
    print;

   Ms =
       + gwwz^2*mw^-4*mz^2*E^2 * (  - 1/4*s )

       + gwwz^2*mw^-2*mz^-2*E^4 * ( 1/2*s*u + 1/4*s^2 )

       + gwwz^2*mw^-2*[s+u]^-1*E^2 * ( s^2 )

       + gwwz^2*mw^-2*E^2 * (  - u - 1/2*s )

       + gwwz^2*mz^-2*[s+u]^-1*E^2 * ( s^2 )

       + gwwz^2*mz^-2*E^2 * (  - 1/2*u - s );

   Mu =
       + gwwz^2*mw^-4*mz^2*E^2 * (  - 1/4*u )

       + gwwz^2*mw^-2*mz^-2*E^4 * ( 1/4*u^2 + 1/2*s*u )

       + gwwz^2*mw^-2*[s+u]^-1*E^2 * (  - s^3*u^-1 )

       + gwwz^2*mw^-2*E^2 * ( 1/2*u - 2*s + s^2*u^-1 )

       + gwwz^2*mz^-2*[s+u]^-1*E^2 * (  - s^3*u^-1 )

       + gwwz^2*mz^-2*E^2 * (  - 3/2*s + s^2*u^-1 );

   M4 =
       + gwwzz*mw^-2*mz^-2*E^4 * (  - 1/4*u^2 - s*u - 1/4*s^2 )

       + gwwzz*mw^-2*[s+u]^-1*E^2 * (  - 2*s^2 )

       + gwwzz*mw^-2*E^2 * ( 1/2*u + 5/2*s )

       + gwwzz*mz^-2*[s+u]^-1*E^2 * (  - 2*s^2 )

       + gwwzz*mz^-2*E^2 * ( 1/2*u + 5/2*s );

    .end
  1.68 sec out of 1.69 sec
